<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Colorlib Templates">
    <meta name="author" content="Colorlib">
    <meta name="keywords" content="Colorlib Templates">

    <!-- Title Page-->
    <title>Register</title>

    <!-- Font special for pages-->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@200;300&display=swap" rel="stylesheet">

    <!-- Main CSS-->
    <link href="accountcss/css/main.css" rel="stylesheet" media="all">
</head>

<body>
    <div class="page-wrapper bg-dark p-t-100 p-b-50">
        <div class="wrapper wrapper--w900">
            <div class="card card-6">
                <div class="card-heading">
                    <h5 class="title">Eataewon Class Register Info</h5>
                </div>
                <div class="card-body">
                    <form id="frm">
                        
                        
                        <div class="form-row">
                            <div class="name">ID</div>
                            <div class="value">
                                <input class="input--style-6" id="userid" type="text">
                            <br><br>       
                            <p id="idcheck"></p>
                            <br>
							<button type="button" id="idcheckBtn"  class="btn btn--radius-2 btn--blue-2">중복확인</button>
                            </div>
                            
                        </div>
                        
                              <div class="form-row">
                            <div class="name">Available ID</div>
                            <div class="value">
                                <input class="input--style-6" id="id" name="id" type="text" readonly="readonly">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="name">Password</div>
                            <div class="value">
                                <input class="input--style-6" type="password" id="pwd" name="pwd" type="text">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="name">Name</div>
                            <div class="value">
                                <input class="input--style-6" type="text" id="name" name="name" type="text">
                            </div>
                        </div>
                        
                        
                        <div class="form-row">
                            <div class="name">Nickname</div>
                            <div class="value">
                                <input class="input--style-6" type="text" id="nickname" name="nickname" type="text">
                            </div>
                        </div>
                        
                       
                        
                        <div class="form-row">
                            <div class="name">Email address</div>
                            <div class="value">
                                <div class="input-group">
                                    <input class="input--style-6" type="text" id="email" name="email" placeholder="example@email.com">
                                </div>
                            </div>
                        </div>
                        
                        
                            <div class="form-row">
                            <div class="name">Profile Photo</div>
                            <div class="value">
                                <div class="input-group js-input-file">
                                	
                               	<div class="imgs_wrap"> 
                                    <input  type="file" name="uploadFiles" multiple id="input_imgs">
                                    </div> 
                                    <div class="imgs_wrap1"></div>                              
                                </div>
                                <div class="label--desc">50 MB 이하의 사진을 등록해주세요.</div>
                            </div>
                        </div>
                        
                        
                        <div class="form-row">
                            <div class="name">Profile Message</div>
                            <div class="value">
                                <div class="input-group">
                                    <textarea class="textarea--style-6" type="text" id="profilmsg" name="profilmsg"></textarea>
                                </div>
                            </div>
                        </div>
                        
                        
                    
                    </form>
                </div>
                <div class="card-footer">
                    <button class="btn btn--radius-2 btn--blue-2" type="button" id="account">회원가입</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Jquery JS-->
    <script src="accountcss/vendor/jquery/jquery.min.js"></script>

    <!-- Main JS-->
    <script src="accountcss/js/global.js"></script>
<script type="text/javascript">

	$(document).ready(function() {
		
		$("#idcheckBtn").click(function() {
			$.ajax({
				url:"http://localhost:3000/getId",
				type:"post",
				data:{"id":$("#userid").val() },
				success:function( msg ){
					//alert('success')
					//alert(msg);
					if(msg.trim()=='OK'){
						$("#idcheck").html("이 아이디는 사용 가능합니다.");
						$("#id").val( $("#userid").val());
					}else{
						$("#idcheck").html("이 아이디는 사용중입니다.");
						$("#userid").val("");//삭제
						$("#userid").focus(); //다시 입력하라고 커서가 뜬다.
					}
				},
				error:function(){
					alert('error');
				}
			});
			
		});
		
		//파일 첨부시 미리보기

		var sel_files = [];

		$("#input_imgs").on("change", handleImgsFilesSelect);

		function handleImgsFilesSelect(e) {
			var files = e.target.files;
			var filesArr = Array.prototype.slice.call(files);

			filesArr.forEach(function(f) {

				sel_files.push(f);
				
				$(".imgs_wrap1").html("");

				var reader = new FileReader();
				reader.onload = function(e) {
					var img_html = "<img src=\""+e.target.result+"\" width='300' height='300'  />";
					$(".imgs_wrap1").append(img_html);
				}
				reader.readAsDataURL(f);
			});
		}

		//첨부파일 미리보기 코드 끝
		
		
		
		$("#account").on("click",function(){
			
			let formData = new FormData( $("#frm")[0] );				
			
			$.ajax({
				url : 'http://localhost:3000/uploadAjaxRegi',
				processData : false,
				contentType : false,
				data : formData,
				type : 'POST',
				enctype:'multipart/form-data',
				cashe:false,
				success : function(result) { 
					if(result=="YES"){
						alert('가입 되었습니다.');
						location.href="bbslist.html";
					}else{
						alert('오류로 인하여 가입되지 않았습니다.');
					}
				},
				error:function(){
					alert('error');
				
				},
				error : function() {
					alert('error');
				}			
		});
		
	});
		
	});
	
	</script>
	





</body>

</html>
